<title>Todos os posts</title>

<ul id="lista-posts">
  <li>Carregando...</li>
</ul>

<script>
  async function carregarTodosOsPosts() {
    const lista = document.getElementById("lista-posts");
    lista.innerHTML = "<h1>Todos os posts:</h1>"; 

    try {
      const res = await fetch("posts/index.json");
      const arquivos = await res.json();

      for (const arquivo of arquivos) {
        try {
          const resPost = await fetch(`posts/${arquivo}`);
          const texto = await resPost.text();
          const doc = new DOMParser().parseFromString(texto, "text/html");
          const titulo = doc.querySelector("title")?.textContent || arquivo;

          const li = document.createElement("li");
          const link = document.createElement("a");
          link.href = `leitura.html?src=posts/${arquivo}`;
          link.textContent = titulo;

          li.appendChild(link);
          lista.appendChild(li);
        } catch (e) {
          console.error("Erro ao carregar post:", arquivo, e);
        }
      }

      if (lista.childElementCount === 0) {
        lista.innerHTML = "<li>Nenhum post encontrado.</li>";
      }

    } catch (erro) {
      console.error("Erro ao carregar index.json:", erro);
      lista.innerHTML = "<li>Erro ao carregar lista de posts.</li>";
    }
  }

  carregarTodosOsPosts();
</script>
